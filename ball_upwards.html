<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Motion in One Dimension (Ball thrown vertically upwards)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { box-sizing: border-box; }
        body { 
            font-family: system-ui, -apple-system, sans-serif; 
            background: #1e1e2f; 
            color: #e0e0e0; 
            margin: 0; 
            padding: 15px; 
            overflow-x: hidden; 
        }
        
        h2 { text-align: center; color: #4fc3f7; margin-top: 5px; }

        #dashboard { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 15px; 
            max-width: 1200px; 
            margin: 0 auto; 
            width: 100%; 
        }

        .panel { 
            background: #2a2a40; 
            padding: 20px; 
            border-radius: 12px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.3); 
            border: 1px solid rgba(255,255,255,0.05);
        }

        #controls { flex: 1 1 300px; }
        #sim { flex: 1 1 250px; display: flex; flex-direction: column; align-items: center;}
        #charts { flex: 2 1 400px; display: flex; flex-direction: column; gap: 15px; }

        .input-row { margin-bottom: 20px; }
        label { display: flex; justify-content: space-between; font-size: 14px; color: #b0bec5; font-weight: bold; }
        .val { color: #4fc3f7; font-family: monospace; font-size: 16px; }
        input[type="range"] { width: 100%; margin-top: 8px; accent-color: #4fc3f7; }
        button { 
            width: 100%; padding: 15px; background: #0288d1; color: white; 
            border: none; border-radius: 8px; font-size: 16px; font-weight: bold; 
            cursor: pointer; transition: background 0.2s;
        }
        button:hover { background: #0277bd; }

        canvas#simCanvas { 
            background: #1a1a2e; 
            border-bottom: 4px solid #4fc3f7; 
            border-radius: 6px; 
            width: 100%; 
            max-width: 300px;
            height: 550px; 
            display: block; 
        }

        .telemetry { display: flex; justify-content: space-between; margin-top: 15px; font-family: monospace; font-size: 14px; color: #81c784; }
        .math-box { 
            background: rgba(0,0,0,0.3); padding: 12px; border-radius: 8px; 
            margin-top: 15px; font-family: 'Courier New', monospace; font-size: 13px; color: #ffd54f;
        }

        .chart-container { position: relative; height: 190px; width: 100%; background: #232336; border-radius: 8px; padding: 10px; }

        /* --- CSS FOR PROPER FRACTIONS --- */
        .math-line { 
            display: flex; 
            align-items: center; 
            margin-bottom: 12px; 
            white-space: nowrap;
        }
        .fraction { 
            display: inline-flex; 
            flex-direction: column; 
            align-items: center; 
            margin: 0 6px; 
            font-size: 0.95em;
        }
        .fraction .num { 
            padding: 0 4px; 
            border-bottom: 1px solid #ffd54f; /* Divider line */
        }
        .fraction .den { 
            padding: 2px 4px 0 4px; 
        }
    </style>
</head>
<body>

    <h2>Motion in One Dimension (Ball thrown vertically upwards)</h2>

    <div id="dashboard">
        <div class="panel" id="controls">
            <div class="input-row">
                <label>Initial Velocity (u) <span class="val" id="uVal">25.0 m/s</span></label>
                <input type="range" id="uSlider" min="5" max="50" step="0.5" value="25">
            </div>
            <div class="input-row">
                <label>Gravity (g) <span class="val" id="gVal">9.8 m/s²</span></label>
                <input type="range" id="gSlider" min="1.6" max="25" step="0.1" value="9.8">
            </div>
            <button id="launchBtn" onclick="launch()">LAUNCH SIMULATION</button>

            <div class="telemetry">
                <span>Time: <b id="tLive">0.00s</b></span>
                <span>Pos (y): <b id="yLive">0.00m</b></span>
                <span style="color:#ffb74d;">Vel (v): <b id="vLive">0.00m/s</b></span>
            </div>

            <div class="math-box" id="calcContent">
                <strong>Analytical Solutions:</strong><br><br>
                Set parameters and click launch.
            </div>
        </div>

        <div class="panel" id="sim">
            <canvas id="simCanvas" width="300" height="550"></canvas>
        </div>

        <div class="panel" id="charts">
            <div class="chart-container">
                <canvas id="posChart"></canvas>
            </div>
            <div class="chart-container">
                <canvas id="velChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        
        let animationId;
        let posChart, velChart;
        let isRunning = false;

        const uSlider = document.getElementById('uSlider');
        const gSlider = document.getElementById('gSlider');
        uSlider.oninput = () => document.getElementById('uVal').innerText = parseFloat(uSlider.value).toFixed(1) + " m/s";
        gSlider.oninput = () => document.getElementById('gVal').innerText = parseFloat(gSlider.value).toFixed(1) + " m/s²";

        Chart.defaults.color = '#a0a0b0';
        Chart.defaults.font.family = 'system-ui';
        
        // Changing to scatter charts for perfectly smooth lines with numerical X-axes
        const posCtx = document.getElementById('posChart').getContext('2d');
        posChart = new Chart(posCtx, {
            type: 'scatter',
            data: { datasets: [{ label: 'Position y(t) [m]', data: [], borderColor: '#4fc3f7', backgroundColor: 'rgba(79, 195, 247, 0.1)', showLine: true, fill: true, pointRadius: 0 }] },
            options: { responsive: true, maintainAspectRatio: false, scales: { x: { type: 'linear', display: false }, y: { beginAtZero: true } }, animation: false }
        });

        const velCtx = document.getElementById('velChart').getContext('2d');
        velChart = new Chart(velCtx, {
            type: 'scatter',
            data: { datasets: [{ label: 'Velocity v(t) [m/s]', data: [], borderColor: '#ffb74d', backgroundColor: 'rgba(255, 183, 77, 0.1)', showLine: true, fill: true, pointRadius: 0 }] },
            options: { responsive: true, maintainAspectRatio: false, scales: { x: { type: 'linear', title: { display: true, text: 'Time (s)' } } }, animation: false }
        });

        function drawVector(x, y, v, scale) {
            if (Math.abs(v) < 0.5) return; 
            
            const length = v * scale;
            ctx.strokeStyle = "#ffb74d";
            ctx.fillStyle = "#ffb74d";
            ctx.lineWidth = 3;
            
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x, y - length); 
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo(x, y - length);
            const headOffset = v > 0 ? 6 : -6;
            ctx.lineTo(x - 6, y - length + headOffset);
            ctx.lineTo(x + 6, y - length + headOffset);
            ctx.fill();
        }

        function drawStopwatch(t) {
            ctx.fillStyle = "rgba(0, 0, 0, 0.5)";
            ctx.beginPath();
            ctx.roundRect(canvas.width - 110, 10, 100, 35, 8);
            ctx.fill();

            ctx.fillStyle = "#fff";
            ctx.font = "18px monospace";
            ctx.textAlign = "right";
            ctx.fillText(`⏱️ ${t.toFixed(2)}s`, canvas.width - 20, 33);
        }

        function launch() {
            if (isRunning) return;
            cancelAnimationFrame(animationId);
            
            const u = parseFloat(uSlider.value);
            const g = parseFloat(gSlider.value);
            
            const tPeak = u / g;
            const hMax = (u * u) / (2 * g);
            const tTotal = tPeak * 2;

            // --- RENDER PROPER MATH FRACTIONS ---
            document.getElementById('calcContent').innerHTML = `
                <div style="margin-bottom: 16px; font-weight:bold;">Substituted Solutions:</div>
                
                <div class="math-line">
                    t_peak = 
                    <div class="fraction"><span class="num">u</span><span class="den">g</span></div> = 
                    <div class="fraction"><span class="num">${u}</span><span class="den">${g}</span></div> = 
                    <b>${tPeak.toFixed(2)}s</b>
                </div>

                <div class="math-line">
                    H_max = 
                    <div class="fraction"><span class="num">u²</span><span class="den">2g</span></div> = 
                    <div class="fraction"><span class="num">${u}²</span><span class="den">2 × ${g}</span></div> = 
                    <b>${hMax.toFixed(2)}m</b>
                </div>

                <div class="math-line">
                    Total Flight = 2 × t_peak = <b>${tTotal.toFixed(2)}s</b>
                </div>
            `;

            posChart.data.datasets[0].data = [];
            velChart.data.datasets[0].data = [];
            
            // Set graph axis limits so they don't jitter
            posChart.options.scales.x.max = tTotal;
            velChart.options.scales.x.max = tTotal;

            posChart.update(); velChart.update();

            document.getElementById('launchBtn').innerText = "SIMULATION RUNNING...";
            document.getElementById('launchBtn').style.background = "#555";
            isRunning = true;

            animate(u, g, hMax, tPeak, tTotal);
        }

        function animate(u, g, hMax, tPeak, tTotal) {
            let startTime = performance.now();
            let lastChartUpdate = -1;
            
            const pxPerMeter = (canvas.height - 50) / (hMax * 1.2); 
            const velScale = (canvas.height * 0.25) / u; 
            const groundY = canvas.height - 25; 

            let tickInterval = hMax < 15 ? 2 : (hMax < 50 ? 5 : 10);

            function step(now) {
                let t = (now - startTime) / 1000; 
                if (t > tTotal) t = tTotal; 

                let y = (u * t) - (0.5 * g * Math.pow(t, 2));
                let v = u - (g * t);

                document.getElementById('tLive').innerText = t.toFixed(2) + "s";
                document.getElementById('yLive').innerText = y.toFixed(2) + "m";
                document.getElementById('vLive').innerText = v.toFixed(2) + "m/s";

                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                ctx.beginPath();
                ctx.strokeStyle = "rgba(255,255,255,0.2)";
                ctx.lineWidth = 1;
                ctx.moveTo(40, 0);
                ctx.lineTo(40, canvas.height);
                ctx.stroke();

                ctx.fillStyle = "#b0bec5";
                ctx.font = "12px monospace";
                ctx.textAlign = "right";
                for(let m = 0; m <= hMax * 1.2; m += tickInterval) {
                    let tickY = groundY - (m * pxPerMeter);
                    ctx.beginPath(); 
                    ctx.moveTo(35, tickY); 
                    ctx.lineTo(40, tickY); 
                    ctx.stroke();
                    ctx.fillText(m + "m", 32, tickY + 4);
                }

                if (t >= tPeak) {
                    let peakY = groundY - (hMax * pxPerMeter);
                    ctx.setLineDash([5, 5]);
                    ctx.strokeStyle = "#ff5252";
                    ctx.beginPath();
                    ctx.moveTo(40, peakY);
                    ctx.lineTo(canvas.width, peakY);
                    ctx.stroke();
                    ctx.setLineDash([]);
                    
                    ctx.fillStyle = "#ff5252";
                    ctx.textAlign = "left";
                    ctx.font = "bold 13px system-ui";
                    ctx.fillText(`H_max = ${hMax.toFixed(2)}m       t_peak = ${tPeak.toFixed(2)}s`, 45, peakY - 8);
                }

                let ballY = groundY - (y * pxPerMeter);
                let ballX = (canvas.width / 2) + 20;

                ctx.beginPath();
                ctx.arc(ballX, ballY, 18, 0, Math.PI * 2); 
                ctx.fillStyle = "#4fc3f7";
                ctx.fill();
                ctx.shadowBlur = 15;
                ctx.shadowColor = "#4fc3f7";
                ctx.shadowBlur = 0; 

                drawVector(ballX, ballY, v, velScale);
                drawStopwatch(t);

                // --- SMOOTH CHART UPDATING ---
                // Using scatter chart {x, y} coordinates instead of labels
                if (t - lastChartUpdate >= 0.05 || t === tTotal) {
                    lastChartUpdate = t;
                    posChart.data.datasets[0].data.push({x: t, y: y});
                    velChart.data.datasets[0].data.push({x: t, y: v});
                    posChart.update('none'); 
                    velChart.update('none');
                }

                if (t < tTotal) {
                    animationId = requestAnimationFrame(step);
                } else {
                    isRunning = false;
                    document.getElementById('launchBtn').innerText = "RESET & RELAUNCH";
                    document.getElementById('launchBtn').style.background = "#0288d1";
                    
                    document.getElementById('yLive').innerText = "0.00m";
                    document.getElementById('vLive').innerText = (-u).toFixed(2) + "m/s";
                }
            }
            requestAnimationFrame(step);
        }
    </script>
</body>
</html>
